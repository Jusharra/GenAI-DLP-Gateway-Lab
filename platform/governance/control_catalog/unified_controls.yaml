standard: Unified AI + Security Control Catalog
version: 1.0

controls:

################################################################################
# GOVERNANCE & RISK – CROSS-FRAMEWORK CORE
################################################################################

  - id: GOV-01
    name: Information Security & AI Policy
    description: >
      Define, approve, communicate, and maintain a unified information security
      and AI governance policy covering data use, DLP, RAG, and AI agents.
    domain: Governance
    requirement: >
      The organization SHALL maintain documented security and AI policies that
      define objectives, scope, roles, responsibilities, and enforcement
      mechanisms, and SHALL review them at planned intervals or when major
      changes occur.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.1, A.5.2"
      - name: ISO42001:2023
        ref: "5.2, 6.1, 6.3"
      - name: ISO27701
        ref: "5.2.1, 5.3.1"
      - name: HIPAA-Security
        ref: "164.308(a)(1)"
    tools:
      opa_policies:
        - policies/governance/policy_enablement.rego
      checkov_checks:
        - CKV_GENERIC_1   # Baseline policy files present in repo
      evidence_sources:
        - platform/docs/security_policy.md
        - platform/docs/ai_governance_policy.md

  - id: GOV-02
    name: Roles, Responsibilities & Separation of Duties
    description: >
      Define and assign responsibilities for security, privacy, and AI
      governance, including DLP owners and OPA policy maintainers.
    domain: Governance
    requirement: >
      Security and privacy roles SHALL be clearly defined, assigned, and
      documented, including responsibilities for approving AI use cases,
      reviewing policies-as-code, and managing exceptions.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.3, A.6.1"
      - name: ISO42001:2023
        ref: "5.3, 7.2"
      - name: ISO27701
        ref: "5.3.1, 6.2.1"
      - name: HIPAA-Security
        ref: "164.308(a)(2)"
    tools:
      opa_policies:
        - policies/governance/role_based_access.rego
      checkov_checks:
        - CKV_AWS_111   # IAM policies attached to groups/roles, not users
      evidence_sources:
        - platform/iam/role_matrix.csv
        - platform/evidence/iam_role_assignments.json

  - id: GOV-03
    name: Risk Assessment for Data & AI Workloads
    description: >
      Perform periodic risk assessments for workloads using RAG, DLP, and AI
      agents, including data movement and model misuse.
    domain: Risk
    requirement: >
      The organization SHALL conduct documented risk assessments that consider
      threats to confidentiality, integrity, availability, and privacy for AI
      and non-AI workloads, and SHALL select controls to reduce risk to an
      acceptable level.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.7, A.8.28"
      - name: ISO42001:2023
        ref: "6.1, 6.3"
      - name: ISO27701
        ref: "5.2.1, 7.2.1"
      - name: HIPAA-Security
        ref: "164.308(a)(1)(ii)(A)-(B)"
    tools:
      opa_policies:
        - policies/risk/data_movement_risk.rego
      checkov_checks:
        - CKV_AWS_20    # S3 server-side encryption
        - CKV_AWS_18    # S3 access logging
      evidence_sources:
        - platform/risk_register/ai_risk_register.yaml
        - platform/evidence/evidence_unified.json

################################################################################
# DATA CLASSIFICATION, LABELING & DLP
################################################################################

  - id: DATA-01
    name: Data Classification & Labeling
    description: >
      Classify and label data (including prompts and RAG corpus) based on
      sensitivity, regulatory obligations, and AI-specific risk.
    domain: Technical
    requirement: >
      Information and datasets SHALL be classified (e.g. PUBLIC, INTERNAL,
      RESTRICTED_PII, RESTRICTED_PHI) and SHALL carry labels or metadata that
      drive access controls, DLP rules, and OPA policy decisions.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.12, A.8.32, A.8.36, A.8.37"
      - name: ISO42001:2023
        ref: "8.2, 8.3"
      - name: ISO27701
        ref: "6.9.1, 7.2.2"
      - name: HIPAA-Security
        ref: "164.308(a)(3), 164.306(a)"
    tools:
      opa_policies:
        - policies/dlp/classification.rego
      checkov_checks:
        - CKV_AWS_21    # S3 buckets not publicly readable
      evidence_sources:
        - platform/devsecops/python/pii_entities.yaml
        - platform/evidence/dlp_classification_samples.json

  - id: DATA-02
    name: Data Leakage Prevention & Data Movement Guardrails
    description: >
      Enforce DLP rules and OPA policies to prevent unauthorized movement of
      PHI/PII from prompts or RAG into logs, model outputs, or external systems.
    domain: Technical
    requirement: >
      Controls SHALL detect, block, or mask unauthorized disclosure of
      sensitive information during collection, processing, storage, and
      transmission, including AI prompt and RAG traffic.
    frameworks:
      - name: ISO27001:2022
        ref: "A.8.34, A.8.35, A.8.36, A.8.38"
      - name: ISO42001:2023
        ref: "8.4, 8.6, 8.7"
      - name: ISO27701
        ref: "6.13.1, 7.4.6"
      - name: HIPAA-Security
        ref: "164.312(e)(1), 164.308(a)(3), 164.312(b)"
    tools:
      opa_policies:
        - policies/dlp/data_movement.rego
      checkov_checks:
        - CKV_AWS_53    # S3 bucket public access block
        - CKV_AWS_145   # S3 bucket versioning / recovery
      evidence_sources:
        - platform/mlsecops/data_movement/flows.json
        - platform/evidence/data_movement_decisions.json

  - id: DATA-03
    name: Data Minimization & Retention
    description: >
      Limit collection, retention, and replication of PHI/PII and AI training
      data to what is necessary for defined purposes.
    domain: Privacy
    requirement: >
      Personal data SHALL be collected and retained only as needed for stated
      purposes and SHALL be securely disposed of or anonymized when no longer
      required.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.14, A.8.10"
      - name: ISO27701
        ref: "7.3.1, 7.3.2, 7.4.1"
      - name: HIPAA-Security
        ref: "164.310(d)(2), 164.306(a)"
    tools:
      opa_policies:
        - policies/privacy/data_retention.rego
      checkov_checks:
        - CKV_AWS_149   # RDS backup retention
      evidence_sources:
        - platform/evidence/data_retention_plan.json
        - platform/evidence/dlp_quarantine_deletions.log

################################################################################
# ACCESS CONTROL & IDENTITY
################################################################################

  - id: ACCESS-01
    name: Identity Management & Least Privilege
    description: >
      Enforce least privilege across IAM roles, AI agents, Lambdas, and
      infrastructure interacting with the DLP/RAG stack.
    domain: Technical
    requirement: >
      Access to systems, PHI/PII, RAG indices, and AI tooling SHALL be limited
      to authorized identities and SHALL follow least-privilege principles,
      including periodic review and revocation.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.15, A.5.18, A.8.2"
      - name: ISO42001:2023
        ref: "8.4, 8.6"
      - name: ISO27701
        ref: "6.7.2, 7.2.1"
      - name: HIPAA-Security
        ref: "164.308(a)(3), 164.308(a)(4), 164.312(a)"
    tools:
      opa_policies:
        - policies/iam/zero_trust_iam.rego
      checkov_checks:
        - CKV_AWS_40    # IAM users with full admin privileges
        - CKV_AWS_41    # IAM policies allow * actions
      evidence_sources:
        - platform/evidence/iam_least_privilege_findings.json

  - id: ACCESS-02
    name: Authentication, MFA & Session Security
    description: >
      Require strong authentication (including MFA) for consoles, CI/CD, and
      privileged AI operations (e.g., modifying OPA or Checkov configs).
    domain: Technical
    requirement: >
      Systems SHALL require strong authentication mechanisms and MFA where
      appropriate, and sessions SHALL be protected against unauthorized use.
    frameworks:
      - name: ISO27001:2022
        ref: "A.5.17, A.8.24"
      - name: ISO27701
        ref: "6.7.2"
      - name: HIPAA-Security
        ref: "164.312(d), 164.308(a)(5)"
    tools:
      opa_policies:
        - policies/iam/session_controls.rego
      checkov_checks:
        - CKV_AWS_189   # Ensure root account MFA is enabled
      evidence_sources:
        - platform/evidence/auth_mfa_status.json

################################################################################
# PRIVACY & ISO 27701 ALIGNMENT
################################################################################

  - id: PRIV-01
    name: Privacy Governance & Roles
    description: >
      Establish privacy governance, including a designated privacy lead and
      oversight for AI that processes personal data.
    domain: Privacy
    requirement: >
      The organization SHALL maintain governance for personal data processing,
      including defined responsibilities, reporting lines, and oversight for AI
      systems using PHI/PII.
    frameworks:
      - name: ISO27701
        ref: "5.1, 5.2.1, 6.2.1"
      - name: ISO27001:2022
        ref: "A.5.1, A.5.3"
      - name: HIPAA-Security
        ref: "164.308(a)(1), 164.308(a)(2)"
    tools:
      opa_policies:
        - policies/privacy/privacy_governance.rego
      checkov_checks: []
      evidence_sources:
        - platform/docs/privacy_program_charter.md

  - id: PRIV-02
    name: Records of Processing & Data Flows
    description: >
      Maintain records of processing activities (RoPA) and data flow diagrams
      for AI and non-AI systems handling personal data.
    domain: Privacy
    requirement: >
      Processing activities involving personal data SHALL be documented,
      including purposes, categories, recipients, data flows, and retention
      periods, and SHALL be reviewed regularly.
    frameworks:
      - name: ISO27701
        ref: "7.2.1, 7.2.6"
      - name: ISO27001:2022
        ref: "A.5.8, A.5.9"
      - name: HIPAA-Security
        ref: "164.308(a)(1), 164.316(b)"
    tools:
      opa_policies:
        - policies/privacy/data_flow_consistency.rego
      checkov_checks: []
      evidence_sources:
        - platform/privacy/records_of_processing.yaml
        - platform/mlsecops/data_movement/flows.json

  - id: PRIV-03
    name: Third-Party Processors & Cloud Vendors
    description: >
      Manage and monitor processors (e.g., Pinecone, OpenAI) that handle
      personal data or embeddings derived from PHI/PII.
    domain: Privacy
    requirement: >
      Third-party processors SHALL be subject to written agreements, risk
      assessments, and ongoing monitoring to ensure adequate protection of
      personal data.
    frameworks:
      - name: ISO27701
        ref: "7.2.3, 7.5.1"
      - name: ISO27001:2022
        ref: "A.5.19, A.5.20"
      - name: HIPAA-Security
        ref: "164.308(b)(1)"
    tools:
      opa_policies:
        - policies/vendor/third_party_data_use.rego
      checkov_checks: []
      evidence_sources:
        - platform/vendor_management/processor_register.csv

################################################################################
# HIPAA SECURITY RULE – SAFEGUARDS
################################################################################

  - id: HIPAA-TECH-01
    name: Encryption & Transmission Security
    description: >
      Use encryption in transit and at rest for PHI and embeddings that may
      contain PHI/PII in the DLP + RAG pipeline.
    domain: Technical
    requirement: >
      Electronic PHI SHALL be protected with encryption and integrity controls
      during transmission and storage where reasonable and appropriate.
    frameworks:
      - name: HIPAA-Security
        ref: "164.312(a)(2)(iv), 164.312(e)(1)"
      - name: ISO27001:2022
        ref: "A.8.24, A.8.25, A.8.28"
    tools:
      opa_policies:
        - policies/crypto/encryption_required.rego
      checkov_checks:
        - CKV_AWS_19    # EBS volume encryption
        - CKV_AWS_20    # S3 SSE enabled
      evidence_sources:
        - platform/evidence/encryption_status.json

  - id: HIPAA-TECH-02
    name: Audit Logging & Integrity Controls
    description: >
      Capture detailed logs for access to PHI, data movement decisions, and RAG
      retrieval events, with integrity protections.
    domain: Technical
    requirement: >
      Systems SHALL implement audit controls that record and examine activity
      in systems containing or using ePHI and SHALL protect logs from
      tampering.
    frameworks:
      - name: HIPAA-Security
        ref: "164.312(b), 164.312(c)(1)"
      - name: ISO27001:2022
        ref: "A.8.15, A.8.16, A.8.9"
    tools:
      opa_policies:
        - policies/logging/log_required.rego
      checkov_checks:
        - CKV_AWS_158   # CloudTrail enabled
      evidence_sources:
        - platform/evidence/audit_logs_snapshot.json
        - platform/evidence/data_movement_decisions.json

################################################################################
# AI-SPECIFIC CONTROLS (ISO 42001 + NIST AI RMF + OWASP LLM)
################################################################################

  - id: AI-01
    name: AI Training & Inference Data Governance
    description: >
      Govern datasets used to train and query AI models, ensuring lawful
      processing, quality, and protection against misuse.
    domain: AI Data Governance
    requirement: >
      Training and inference datasets SHALL be documented, quality-checked,
      access-controlled, and reviewed for PHI/PII leakage and regulatory
      obligations.
    frameworks:
      - name: ISO42001:2023
        ref: "8.2, 8.3"
      - name: ISO27701
        ref: "7.2.2, 7.2.6"
      - name: NIST AI RMF
        ref: "MAP-1, MEASURE-1"
    tools:
      opa_policies:
        - policies/datasets/dataset_registration.rego
      checkov_checks: []
      evidence_sources:
        - platform/evidence/ai_dataset_inventory.json

  - id: AI-02
    name: AI Robustness, Abuse Resistance & Monitoring
    description: >
      Implement controls to detect prompt injection, jailbreak attempts, and
      anomalous RAG behavior, with ongoing monitoring.
    domain: AI Security
    requirement: >
      AI systems SHALL be designed and monitored to resist adversarial prompts,
      misuse, and drift, and anomalies SHALL trigger alerts and investigation.
    frameworks:
      - name: ISO42001:2023
        ref: "8.4, 8.5, 8.7"
      - name: NIST AI RMF
        ref: "MANAGE-1, MONITOR-1"
      - name: OWASP LLM Top 10
        ref: "LLM01, LLM02, LLM08, LLM09"
    tools:
      opa_policies:
        - policies/ai/prompt_injection_guardrails.rego
        - policies/ai/rag_safety.rego
      checkov_checks: []
      evidence_sources:
        - platform/evidence/ai_security_events.json

  - id: AI-03
    name: Human Oversight & Explainability
    description: >
      Provide human review paths and explainable outputs for DLP decisions,
      OPA data movement results, and RAG evidence bundles.
    domain: Governance
    requirement: >
      Material decisions derived from AI or automated DLP SHALL be subject to
      human oversight, and the reasoning behind decisions SHALL be available
      in a human-readable form.
    frameworks:
      - name: ISO42001:2023
        ref: "8.6, 8.7"
      - name: NIST AI RMF
        ref: "GOVERN-1, MANAGE-1"
    tools:
      opa_policies:
        - policies/dlp/human_review_escalation.rego
      checkov_checks: []
      evidence_sources:
        - platform/evidence/data_movement_decisions.json
        - platform/evidence/human_review_cases.json
