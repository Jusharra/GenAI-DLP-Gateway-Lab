{
  "flows": [
    {
      "id": "user_to_gateway_internal",
      "from": "user",
      "to": "dlp_gateway",
      "allowed": true,
      "conditions": [
        "classification_label not_in [RESTRICTED_PII, RESTRICTED_PHI]",
        "policy_decision.action in [allow,mask]"
      ]
    },
    {
      "id": "gateway_to_rag_internal",
      "from": "dlp_gateway",
      "to": "rag_orchestrator",
      "allowed": true,
      "conditions": [
        "classification_label not_in [RESTRICTED_PII, RESTRICTED_PHI]",
        "policy_decision.action in [allow,mask]"
      ]
    },
    {
      "id": "rag_to_pinecone_internal",
      "from": "rag_orchestrator",
      "to": "pinecone",
      "allowed": true,
      "conditions": [
        "classification_label not_in [RESTRICTED_PII, RESTRICTED_PHI]",
        "policy_decision.action in [allow,mask]"
      ]
    }
  ]
}
